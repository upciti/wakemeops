- name: mattermost-desktop
  version: 5.0.4
  homepage: https://mattermost.com
  summary: desktop application for Mattermost
  description: |-
    Mattermost is an open source platform for secure communication, collaboration,
    and orchestration of work across teams and tools.

    Mattermost is built specifically for software development and engineering use
    cases and integrates deeply with a rich ecosystem of third-party developer
    tools. Mattermost gives companies full control over their data; with self-
    hosted and private cloud deployment options and access to the source code,
    developers can contribute directly to a shared, flexible, and extensible
    platform built just for them.
  fetch: https://releases.mattermost.com/desktop/{{version}}/mattermost-desktop-{{version}}-linux-x64.tar.gz
  script:
    - install -d {{src}}/opt
    - find . -type f -exec chmod 644 -- {} +
    - find . -type d -exec chmod 775 -- {} +
    - chmod 755 mattermost-desktop-{{version}}-linux-x64/mattermost-desktop
    - mv mattermost-desktop-{{version}}-linux-x64 {{src}}/opt/mattermost-desktop
    - ln -s /opt/mattermost-desktop/mattermost-desktop {{src}}/usr/bin/mattermost-desktop
    - install -d {{src}}/usr/share/applications
    - |-
      cat << EOF >> {{src}}/usr/share/applications/mattermost.desktop
      [Desktop Entry]
      Name=Mattermost
      Comment=Mattermost Desktop application for Linux
      Exec="/opt/mattermost-desktop/mattermost-desktop"
      Terminal=false
      Type=Application
      Icon=/opt/mattermost-desktop/app_icon.png
      Categories=Network;InstantMessaging;
      EOF

- name: mattermost-desktop
  matrix:
    versions:
      - 5.1.0
      - 5.1.1
      - 5.2.0
      - 5.2.1
      - 5.2.2
      - 5.3.0
  homepage: https://mattermost.com
  summary: desktop application for Mattermost
  description: |-
    Mattermost is an open source platform for secure communication, collaboration,
    and orchestration of work across teams and tools.

    Mattermost is built specifically for software development and engineering use
    cases and integrates deeply with a rich ecosystem of third-party developer
    tools. Mattermost gives companies full control over their data; with self-
    hosted and private cloud deployment options and access to the source code,
    developers can contribute directly to a shared, flexible, and extensible
    platform built just for them.
  fetch: https://releases.mattermost.com/desktop/{{version}}/mattermost-desktop-{{version}}-linux-x64.tar.gz
  install:
    - content: |-
        [Desktop Entry]
        Name=Mattermost
        Comment=Mattermost Desktop application for Linux
        Exec="/opt/mattermost-desktop/mattermost-desktop"
        Terminal=false
        Type=Application
        Icon=/opt/mattermost-desktop/app_icon.png
        Categories=Network;InstantMessaging;
      path: /usr/share/applications/mattermost.desktop
  script:
    - install -d {{src}}/opt
    - find . -type f -exec chmod 644 -- {} +
    - find . -type d -exec chmod 775 -- {} +
    - chmod 755 mattermost-desktop-{{version}}-linux-x64/mattermost-desktop
    - mv mattermost-desktop-{{version}}-linux-x64 {{src}}/opt/mattermost-desktop
    - ln -s /opt/mattermost-desktop/mattermost-desktop {{src}}/usr/bin/mattermost-desktop
